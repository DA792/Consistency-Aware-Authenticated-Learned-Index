# 生成100万点数据集

## 🚀 快速开始

### 一键生成

```batch
generate_datasets.bat
```

## 📊 数据集信息

### 生成的数据集

- **文件名**: `uniform_1000k.csv`
- **数据点数**: 1,000,000 (100万)
- **分布类型**: 均匀分布
- **坐标范围**: X [0, 999999], Y [0, 999999]
- **文件大小**: 约 20 MB
- **生成时间**: 20-40秒

### 数据格式

```csv
x,y
123456,789012
234567,890123
345678,901234
...
```

## 📁 文件位置

```
Consistency-Aware-Authenticated-Learned-Index/
  └── src/
      └── data/
          └── uniform_1000k.csv  ← 生成在这里
```

## 🔧 如何使用

### 1. 生成数据集

```batch
generate_datasets.bat
```

### 2. 修改测试代码

编辑 `Spatial2DPVLTree.java` 第 188-189 行:

```java
// 修改数据路径和加载数量
String dataPath = "src/data/uniform_1000k.csv";
int loadCount = 1000000;
```

### 3. 调整参数 (重要!)

对于100万数据,建议增大误差界限:

```java
// 第 204 行
int err = 128;  // 从64改为128,适合大数据集
```

### 4. 运行测试

```batch
run_2d_pvl_test.bat
```

## 💡 性能建议

### 推荐配置 (100万点)

```java
// Spatial2DPVLTree.java
int err = 128;  // 误差界限

// ZOrderDecomposition.java (已优化)
if (level >= 10 || (zEnd - zStart) <= 1) {
```

### 预期性能

| 指标 | 预期值 |
|------|--------|
| 构建时间 | 8-15秒 |
| 查询时间 (选择性0.02) | 10-20 ms |
| 验证时间 (选择性0.02) | 30-50 ms |
| 内存占用 | 200-300 MB |

### 如果性能不够

可以进一步增大误差界限:

```java
int err = 256;  // 更激进的优化
```

或者减少Z区间递归深度:

```java
// ZOrderDecomposition.java 第58行
if (level >= 8 || (zEnd - zStart) <= 1) {  // 从10改为8
```

## ⚙️ 内存设置

对于100万点数据,建议增加JVM内存:

```batch
java -Xmx2g -cp "jars/*;bin" index.spatial_2d_pvl.Spatial2DPVLTree
```

可以修改 `run_2d_pvl_test.bat`:

```batch
java -Xmx2g -cp "jars/*;bin" index.spatial_2d_pvl.Spatial2DPVLTree
```

## 📈 测试流程

### 完整测试步骤

1. **生成数据集** (只需一次)
   ```batch
   generate_datasets.bat
   ```

2. **修改测试代码**
   - 数据路径: `uniform_1000k.csv`
   - 加载数量: `1000000`
   - 误差界限: `128`

3. **运行测试**
   ```batch
   run_2d_pvl_test.bat
   ```

4. **查看结果**
   - 构建时间
   - 查询时间
   - Z区间数
   - VO大小

## 🎯 预期测试结果

### 优化后的性能 (err=128, level≥10)

```
选择性 0.02:
- Z区间数: 700-1000 (优化前: 2811)
- 查询时间: ~2-3 ms
- 验证时间: ~8-12 ms
- 总时间: ~10-15 ms
- VO大小: ~800-1200 KB
```

## ⚠️ 注意事项

1. **磁盘空间**: 确保有至少 50 MB 可用空间
2. **内存**: 需要至少 1 GB 可用内存
3. **生成时间**: 首次生成需要 20-40秒,请耐心等待
4. **进度显示**: 每生成10万点会显示进度

## 🔍 验证数据集

生成后可以验证:

```java
List<Point2D> points = DataLoader.loadFromCSV("src/data/uniform_1000k.csv", 1000000);
System.out.println("成功加载: " + points.size() + " 个点");

DataLoader.DataStats stats = DataLoader.analyzeData(points);
System.out.println(stats);
```

预期输出:
```
成功加载: 1000000 个点
数据统计: 1000000 个点
X范围: [0, 999999]
Y范围: [0, 999999]
```

## 🚀 开始生成

现在运行:

```batch
generate_datasets.bat
```

等待20-40秒,数据集就生成好了! 🎉









