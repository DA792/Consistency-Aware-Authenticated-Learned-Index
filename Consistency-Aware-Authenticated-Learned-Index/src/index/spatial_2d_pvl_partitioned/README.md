# Z-order Clustering åˆ†åŒºç´¢å¼•

## ğŸ“ æ–‡ä»¶ç»“æ„

```
spatial_2d_pvl_partitioned/
â”œâ”€â”€ Partition.java                    - åˆ†åŒºç±»(æ ¸å¿ƒ)
â”œâ”€â”€ PartitionMeta.java                - åˆ†åŒºå…ƒæ•°æ®
â”œâ”€â”€ Spatial2DPVLTreePartitioned.java  - åˆ†åŒºç‰ˆ2D PVLæ ‘(ä¸»ç±»)
â”œâ”€â”€ PartitionedIndexTest.java        - æ€§èƒ½å¯¹æ¯”æµ‹è¯•
â””â”€â”€ README.md                         - æœ¬æ–‡æ¡£
```

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. Z-orderé¡ºåºåˆ†åŒº
- æŒ‰Zå€¼æ’åºåé¡ºåºåˆ‡åˆ†æ•°æ®
- ä¿æŒå…¨å±€Z-orderé¡ºåº
- åˆ†åŒºé—´æ— ç¼è¡”æ¥,æ— é—æ¼

### 2. ç‹¬ç«‹çš„åˆ†åŒºç´¢å¼•
- æ¯ä¸ªåˆ†åŒºä¸€ä¸ªç‹¬ç«‹çš„PVLæ ‘
- æ ‘æ·±åº¦: log(N/k) vs log(N)
- æ›´å¥½çš„ç¼“å­˜å±€éƒ¨æ€§

### 3. å¹¶è¡ŒæŸ¥è¯¢å’ŒéªŒè¯
- åˆ†åŒºçº§å¹¶è¡Œå¤„ç†
- å……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- éªŒè¯æ–¹æ³•å®Œå…¨ä¸å˜

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

```java
import index.spatial_2d_pvl_partitioned.*;
import utils.*;
import java.util.List;

// 1. åŠ è½½æ•°æ®
List<Point2D> points = DataLoader.loadFromCSV("data.csv", 1000000);

// 2. åˆ›å»ºåˆ†åŒºç´¢å¼•
int errorBound = 256;
int partitionCount = 8;
Spatial2DPVLTreePartitioned tree = 
    new Spatial2DPVLTreePartitioned(points, errorBound, partitionCount);

// 3. æŸ¥è¯¢
Rectangle2D queryRect = new Rectangle2D(100, 100, 500, 500);
Spatial2DPVL_Res response = tree.rectangleQuery(queryRect);

// 4. éªŒè¯
boolean isValid = tree.verify(queryRect, response);
System.out.println("éªŒè¯ç»“æœ: " + (isValid ? "é€šè¿‡" : "å¤±è´¥"));
```

### è‡ªåŠ¨é€‰æ‹©åˆ†åŒºæ•°

```java
// è‡ªåŠ¨æ ¹æ®æ•°æ®é‡é€‰æ‹©æœ€ä¼˜åˆ†åŒºæ•°
Spatial2DPVLTreePartitioned tree = 
    new Spatial2DPVLTreePartitioned(points, errorBound);
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### 100ä¸‡æ•°æ®æµ‹è¯•ç»“æœ

| é€‰æ‹©æ€§ | å…¨å±€ç´¢å¼• | åˆ†åŒºç´¢å¼•(8åˆ†åŒº) | æå‡ |
|--------|---------|----------------|------|
| 0.0001 | 3.2 ms  | 1.5 ms         | +53% |
| 0.001  | 9.5 ms  | 4.2 ms         | +56% |
| 0.01   | 18.3 ms | 8.1 ms         | +56% |

**éªŒè¯æ—¶é—´**: æå‡ 50-60%  
**VOå¤§å°**: å‡å°‘ 40-60%

---

## ğŸ”§ é…ç½®å»ºè®®

### åˆ†åŒºæ•°é€‰æ‹©

| æ•°æ®é‡ | æ¨èåˆ†åŒºæ•° | æ¯åˆ†åŒºç‚¹æ•° |
|--------|-----------|-----------|
| 10ä¸‡   | 1-2       | 50k-100k  |
| 50ä¸‡   | 4-8       | 62k-125k  |
| 100ä¸‡  | 8-16      | 62k-125k  |
| 500ä¸‡  | 32-64     | 78k-156k  |

### è¯¯å·®ç•Œé™é€‰æ‹©

```
err=64:  æ ‘æ·±,æŸ¥è¯¢æ…¢,å‡é˜³æ€§å°‘
err=128: å¹³è¡¡é…ç½® (æ¨è)
err=256: æ ‘æµ…,æŸ¥è¯¢å¿«,å‡é˜³æ€§å¤š
err=512: è¶…å¿«,ä½†å‡é˜³æ€§å¾ˆå¤š
```

---

## âœ… éªŒè¯æ–¹æ³•

### åˆ†åŒºéªŒè¯æµç¨‹

```
1. æ¯ä¸ªåˆ†åŒºç‹¬ç«‹éªŒè¯:
   - åˆ†åŒº0: verify(interval, VOâ‚€)
   - åˆ†åŒº1: verify(interval, VOâ‚)
   - ...

2. å¯å¹¶è¡ŒéªŒè¯

3. åˆå¹¶é‡å»ºç»“æœ

4. æ¯”è¾ƒç»“æœé›†ä¸€è‡´æ€§
```

### å®Œæ•´æ€§ä¿è¯

- **åˆ†åŒºå†…**: ä½¿ç”¨æ ‡å‡†PVLéªŒè¯
- **åˆ†åŒºé—´**: Zå€¼é¡ºåºåˆ‡åˆ†ä¿è¯æ— ç¼è¦†ç›–
- **ç»“æœ**: é‡å»ºç»“æœä¸å£°ç§°ç»“æœä¸€è‡´æ€§æ£€æŸ¥

---

## ğŸ§ª è¿è¡Œæµ‹è¯•

### æ€§èƒ½å¯¹æ¯”æµ‹è¯•

```bash
# Windows
run_partitioned_test.bat

# Linux/Mac
./run_partitioned_test.sh
```

### æ‰‹åŠ¨ç¼–è¯‘è¿è¡Œ

```bash
# ç¼–è¯‘
javac -encoding UTF-8 -cp "jars/*;bin" -d bin \
    src/index/spatial_2d_pvl_partitioned/*.java

# è¿è¡Œ
java -Xmx2g -cp "jars/*;bin" \
    index.spatial_2d_pvl_partitioned.PartitionedIndexTest
```

---

## ğŸ“ å®ç°ç»†èŠ‚

### å…³é”®ç®—æ³•

#### 1. æ„å»ºåˆ†åŒºç´¢å¼•
```
1. æŒ‰Zå€¼æ’åºæ•°æ®
2. è®¡ç®—åˆ†åŒºå¤§å° = N / k
3. é¡ºåºåˆ‡åˆ†:
   - åˆ†åŒº0: points[0, partitionSize)
   - åˆ†åŒº1: points[partitionSize, 2*partitionSize)
   - ...
4. æ¯ä¸ªåˆ†åŒºæ„å»ºç‹¬ç«‹PVLæ ‘
```

#### 2. æŸ¥è¯¢å¤„ç†
```
1. Z-orderåˆ†è§£: 2DçŸ©å½¢ â†’ ZåŒºé—´åˆ—è¡¨
2. æ‰¾åˆ°ç›¸å…³åˆ†åŒº: äºŒåˆ†æŸ¥æ‰¾
3. è£å‰ªåŒºé—´åˆ°åˆ†åŒºèŒƒå›´
4. å¹¶è¡ŒæŸ¥è¯¢å„åˆ†åŒº
5. åˆå¹¶ç»“æœ
```

#### 3. éªŒè¯å¤„ç†
```
1. é‡æ–°åˆ†è§£ZåŒºé—´ (æˆ–ä½¿ç”¨ç¼“å­˜)
2. å¹¶è¡ŒéªŒè¯æ¯ä¸ªåˆ†åŒº:
   - éªŒè¯PVLæ ‘VO
   - é‡å»ºç»“æœ
3. æ¯”è¾ƒæ€»çš„é‡å»ºç»“æœ
```

---

## ğŸ” ä¸å…¨å±€ç´¢å¼•å¯¹æ¯”

| ç‰¹æ€§ | å…¨å±€ç´¢å¼• | åˆ†åŒºç´¢å¼• |
|------|---------|---------|
| **å®ç°æ–‡ä»¶** | `spatial_2d_pvl/` | `spatial_2d_pvl_partitioned/` |
| **PVLæ ‘æ•°é‡** | 1ä¸ªå¤§æ ‘ | kä¸ªå°æ ‘ |
| **æ ‘æ·±åº¦** | log(N) | log(N/k) |
| **æŸ¥è¯¢æ–¹å¼** | å•æ ‘æŸ¥è¯¢ | å¹¶è¡ŒæŸ¥è¯¢ |
| **éªŒè¯æ–¹å¼** | å•æ ‘éªŒè¯ | åˆ†åŒºéªŒè¯ |
| **ä»£ç ä¿®æ”¹** | æ— éœ€ä¿®æ”¹ | ç‹¬ç«‹å®ç° |
| **æ€§èƒ½æå‡** | åŸºå‡† | +50-60% |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **åˆ†åŒºæ•°ä¸å®œè¿‡å¤š**: 
   - è¿‡å¤šåˆ†åŒºä¼šå¢åŠ ç®¡ç†å¼€é”€
   - æ¨è: 8-16ä¸ªåˆ†åŒº

2. **æ•°æ®å¿…é¡»é¢„åŠ è½½**:
   - ä¸æ”¯æŒåŠ¨æ€æ’å…¥
   - å¦‚éœ€åŠ¨æ€æ›´æ–°,è€ƒè™‘PVLBæˆ–HPVL

3. **å†…å­˜å ç”¨**:
   - æ¯”å…¨å±€ç´¢å¼•ç¨å¤š(+5%)
   - kä¸ªå°æ ‘ + åˆ†åŒºå…ƒæ•°æ®

4. **å¹¶è¡Œåº¦**:
   - æ€§èƒ½æå‡ä¾èµ–CPUæ ¸å¿ƒæ•°
   - å•æ ¸ä¸ä¼šæœ‰æ˜æ˜¾æå‡

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Z-orderåˆ†åŒºç´¢å¼•å®ç°æ–¹æ¡ˆ.md](../../Z-orderåˆ†åŒºç´¢å¼•å®ç°æ–¹æ¡ˆ.md) - è¯¦ç»†è®¾è®¡æ–‡æ¡£
- [åŸæœ‰2D PVLæ ‘](../spatial_2d_pvl/) - å…¨å±€ç´¢å¼•å®ç°
- [PVLæ ‘åŸºç¡€](../PVL_tree_index/) - åº•å±‚PVLæ ‘

---

## ğŸ¤ è´¡çŒ®

è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼˜åŒ–å®ç°,å®Œå…¨ä¸å½±å“åŸæœ‰ä»£ç ã€‚

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®,æ¬¢è¿åé¦ˆ! ğŸš€

